<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reconhecimento do Alfabeto em Libras</title>
  <style>
    /* seu CSS continua igual, perfeito! */
    /* (não repeti aqui para ficar mais compacto) */
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Reconhecimento do Alfabeto em Libras</h1>
      <p>Aprenda e pratique o alfabeto da Língua Brasileira de Sinais</p>
    </header>

    <div class="video-container">
      <video id="video" autoplay muted playsinline></video>
    </div>

    <div class="camera-status">Câmera ativa</div>

    <div class="btn-container">
      <button id="pauseBtn" class="btn">Pausar</button>
    </div>

    <div class="letter-display">
      <div class="letter-box" id="detectedLetter"></div>
      <div class="letter-instruction">Faça um sinal para reconhecer</div>
      <div class="letter-recognized">Letra reconhecida: <span id="recognizedLetter"></span></div>
    </div>
  </div>

  <div class="container instructions">
    <h2>Como usar:</h2>
    <ol>
      <li>A câmera liga automaticamente</li>
      <li>Posicione sua mão no centro da imagem</li>
      <li>Faça o sinal da letra desejada</li>
      <li>A letra detectada aparecerá na tela</li>
    </ol>
  </div>

  <div class="container">
    <h3 style="text-align: center;">Escolha uma letra para praticar:</h3>
    <div id="letterToShow"></div>
    <div class="alphabet-grid">
      <!-- Todas as letras A-Z -->
      <div class="alphabet-letter" data-letter="A">A</div>
      <div class="alphabet-letter" data-letter="B">B</div>
      <div class="alphabet-letter" data-letter="C">C</div>
      <div class="alphabet-letter" data-letter="D">D</div>
      <div class="alphabet-letter" data-letter="E">E</div>
      <div class="alphabet-letter" data-letter="F">F</div>
      <div class="alphabet-letter" data-letter="G">G</div>
      <div class="alphabet-letter" data-letter="H">H</div>
      <div class="alphabet-letter" data-letter="I">I</div>
      <div class="alphabet-letter" data-letter="J">J</div>
      <div class="alphabet-letter" data-letter="K">K</div>
      <div class="alphabet-letter" data-letter="L">L</div>
      <div class="alphabet-letter" data-letter="M">M</div>
      <div class="alphabet-letter" data-letter="N">N</div>
      <div class="alphabet-letter" data-letter="O">O</div>
      <div class="alphabet-letter" data-letter="P">P</div>
      <div class="alphabet-letter" data-letter="Q">Q</div>
      <div class="alphabet-letter" data-letter="R">R</div>
      <div class="alphabet-letter" data-letter="S">S</div>
      <div class="alphabet-letter" data-letter="T">T</div>
      <div class="alphabet-letter" data-letter="U">U</div>
      <div class="alphabet-letter" data-letter="V">V</div>
      <div class="alphabet-letter" data-letter="W">W</div>
      <div class="alphabet-letter" data-letter="X">X</div>
      <div class="alphabet-letter" data-letter="Y">Y</div>
      <div class="alphabet-letter" data-letter="Z">Z</div>
    </div>
  </div>

  <div class="footer">
    Desenvolvido por André Vitor, Sarah Ramos e Julçio Cerar
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const video = document.getElementById('video');
      const pauseBtn = document.getElementById('pauseBtn');
      const detectedLetter = document.getElementById('detectedLetter');
      const recognizedLetter = document.getElementById('recognizedLetter');
      const letterToShow = document.getElementById('letterToShow');
      const alphabetLetters = document.querySelectorAll('.alphabet-letter');

      let isPaused = false;

      // Iniciar a câmera via navegador
      async function startCamera() {
        try {
          const stream = await navigator.mediaDevices.getUserMedia({ video: true });
          video.srcObject = stream;
        } catch (error) {
          alert('Não foi possível acessar a câmera. Verifique as permissões.');
          console.error(error);
        }
      }

      startCamera();

      // Atualizar a letra detectada
      function updateDetectedLetter() {
        if (!isPaused) {
          fetch('/get_letter')
            .then(response => response.json())
            .then(data => {
              if (data.letter) {
                detectedLetter.textContent = data.letter;
                recognizedLetter.textContent = data.letter;

                const activeLetter = document.querySelector('.alphabet-letter.active');
                if (activeLetter && activeLetter.dataset.letter === data.letter) {
                  activeLetter.style.backgroundColor = '#28a745';
                  setTimeout(() => {
                    activeLetter.style.backgroundColor = '';
                    activeLetter.classList.add('active');
                  }, 1000);
                }
              }
              setTimeout(updateDetectedLetter, 500);
            })
            .catch(error => {
              console.error('Erro ao obter a letra:', error);
              setTimeout(updateDetectedLetter, 1000);
            });
        }
      }

      updateDetectedLetter();

      // Botão de pausar/retomar
      pauseBtn.addEventListener('click', function () {
        isPaused = !isPaused;
        pauseBtn.textContent = isPaused ? 'Retomar' : 'Pausar';
        if (!isPaused) updateDetectedLetter();
      });

      // Clicar nas letras para praticar
      alphabetLetters.forEach(letter => {
        letter.addEventListener('click', function () {
          alphabetLetters.forEach(l => l.classList.remove('active'));
          this.classList.add('active');
          letterToShow.textContent = `Pratique a letra: ${this.dataset.letter}`;
        });
      });
    });
  </script>
</body>
</html>
